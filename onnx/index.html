<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/7.0.0/math.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/onnxjs/dist/onnx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/random-js/1.0.8/random.min.js"></script>
</head>

<body>
  <script>
    grid = math.matrix([[-1., 1., 1.], [-0.9259, 1.0000, 1.0000], [-0.8519, 1.0000, 1.0000], [-0.7778, 1.0000, 1.0000], [-0.7037, 1.0000, 1.0000], [-0.6296, 1.0000, 1.0000], [-0.5556, 1.0000, 1.0000], [-0.4815, 1.0000, 1.0000], [-0.4074, 1.0000, 1.0000], [-0.3333, 1.0000, 1.0000], [-0.2593, 1.0000, 1.0000], [-0.1852, 1.0000, 1.0000], [-0.1111, 1.0000, 1.0000], [-0.0370, 1.0000, 1.0000], [0.0370, 1.0000, 1.0000], [0.1111, 1.0000, 1.0000], [0.1852, 1.0000, 1.0000], [0.2593, 1.0000, 1.0000], [0.3333, 1.0000, 1.0000], [0.4074, 1.0000, 1.0000], [0.4815, 1.0000, 1.0000], [0.5556, 1.0000, 1.0000], [0.6296, 1.0000, 1.0000], [0.7037, 1.0000, 1.0000], [0.7778, 1.0000, 1.0000], [0.8519, 1.0000, 1.0000], [0.9259, 1.0000, 1.0000], [1., 1., 1.], [-1.0000, 0.9259, 1.0000], [-0.9259, 0.9259, 1.0000], [-0.8519, 0.9259, 1.0000], [-0.7778, 0.9259, 1.0000], [-0.7037, 0.9259, 1.0000], [-0.6296, 0.9259, 1.0000], [-0.5556, 0.9259, 1.0000], [-0.4815, 0.9259, 1.0000], [-0.4074, 0.9259, 1.0000], [-0.3333, 0.9259, 1.0000], [-0.2593, 0.9259, 1.0000], [-0.1852, 0.9259, 1.0000], [-0.1111, 0.9259, 1.0000], [-0.0370, 0.9259, 1.0000], [0.0370, 0.9259, 1.0000], [0.1111, 0.9259, 1.0000], [0.1852, 0.9259, 1.0000], [0.2593, 0.9259, 1.0000], [0.3333, 0.9259, 1.0000], [0.4074, 0.9259, 1.0000], [0.4815, 0.9259, 1.0000], [0.5556, 0.9259, 1.0000], [0.6296, 0.9259, 1.0000], [0.7037, 0.9259, 1.0000], [0.7778, 0.9259, 1.0000], [0.8519, 0.9259, 1.0000], [0.9259, 0.9259, 1.0000], [1.0000, 0.9259, 1.0000], [-1.0000, 0.8519, 1.0000], [-0.9259, 0.8519, 1.0000], [-0.8519, 0.8519, 1.0000], [-0.7778, 0.8519, 1.0000], [-0.7037, 0.8519, 1.0000], [-0.6296, 0.8519, 1.0000], [-0.5556, 0.8519, 1.0000], [-0.4815, 0.8519, 1.0000], [-0.4074, 0.8519, 1.0000], [-0.3333, 0.8519, 1.0000], [-0.2593, 0.8519, 1.0000], [-0.1852, 0.8519, 1.0000], [-0.1111, 0.8519, 1.0000], [-0.0370, 0.8519, 1.0000], [0.0370, 0.8519, 1.0000], [0.1111, 0.8519, 1.0000], [0.1852, 0.8519, 1.0000], [0.2593, 0.8519, 1.0000], [0.3333, 0.8519, 1.0000], [0.4074, 0.8519, 1.0000], [0.4815, 0.8519, 1.0000], [0.5556, 0.8519, 1.0000], [0.6296, 0.8519, 1.0000], [0.7037, 0.8519, 1.0000], [0.7778, 0.8519, 1.0000], [0.8519, 0.8519, 1.0000], [0.9259, 0.8519, 1.0000], [1.0000, 0.8519, 1.0000], [-1.0000, 0.7778, 1.0000], [-0.9259, 0.7778, 1.0000], [-0.8519, 0.7778, 1.0000], [-0.7778, 0.7778, 1.0000], [-0.7037, 0.7778, 1.0000], [-0.6296, 0.7778, 1.0000], [-0.5556, 0.7778, 1.0000], [-0.4815, 0.7778, 1.0000], [-0.4074, 0.7778, 1.0000], [-0.3333, 0.7778, 1.0000], [-0.2593, 0.7778, 1.0000], [-0.1852, 0.7778, 1.0000], [-0.1111, 0.7778, 1.0000], [-0.0370, 0.7778, 1.0000], [0.0370, 0.7778, 1.0000], [0.1111, 0.7778, 1.0000], [0.1852, 0.7778, 1.0000], [0.2593, 0.7778, 1.0000], [0.3333, 0.7778, 1.0000], [0.4074, 0.7778, 1.0000], [0.4815, 0.7778, 1.0000], [0.5556, 0.7778, 1.0000], [0.6296, 0.7778, 1.0000], [0.7037, 0.7778, 1.0000], [0.7778, 0.7778, 1.0000], [0.8519, 0.7778, 1.0000], [0.9259, 0.7778, 1.0000], [1.0000, 0.7778, 1.0000], [-1.0000, 0.7037, 1.0000], [-0.9259, 0.7037, 1.0000], [-0.8519, 0.7037, 1.0000], [-0.7778, 0.7037, 1.0000], [-0.7037, 0.7037, 1.0000], [-0.6296, 0.7037, 1.0000], [-0.5556, 0.7037, 1.0000], [-0.4815, 0.7037, 1.0000], [-0.4074, 0.7037, 1.0000], [-0.3333, 0.7037, 1.0000], [-0.2593, 0.7037, 1.0000], [-0.1852, 0.7037, 1.0000], [-0.1111, 0.7037, 1.0000], [-0.0370, 0.7037, 1.0000], [0.0370, 0.7037, 1.0000], [0.1111, 0.7037, 1.0000], [0.1852, 0.7037, 1.0000], [0.2593, 0.7037, 1.0000], [0.3333, 0.7037, 1.0000], [0.4074, 0.7037, 1.0000], [0.4815, 0.7037, 1.0000], [0.5556, 0.7037, 1.0000], [0.6296, 0.7037, 1.0000], [0.7037, 0.7037, 1.0000], [0.7778, 0.7037, 1.0000], [0.8519, 0.7037, 1.0000], [0.9259, 0.7037, 1.0000], [1.0000, 0.7037, 1.0000], [-1.0000, 0.6296, 1.0000], [-0.9259, 0.6296, 1.0000], [-0.8519, 0.6296, 1.0000], [-0.7778, 0.6296, 1.0000], [-0.7037, 0.6296, 1.0000], [-0.6296, 0.6296, 1.0000], [-0.5556, 0.6296, 1.0000], [-0.4815, 0.6296, 1.0000], [-0.4074, 0.6296, 1.0000], [-0.3333, 0.6296, 1.0000], [-0.2593, 0.6296, 1.0000], [-0.1852, 0.6296, 1.0000], [-0.1111, 0.6296, 1.0000], [-0.0370, 0.6296, 1.0000], [0.0370, 0.6296, 1.0000], [0.1111, 0.6296, 1.0000], [0.1852, 0.6296, 1.0000], [0.2593, 0.6296, 1.0000], [0.3333, 0.6296, 1.0000], [0.4074, 0.6296, 1.0000], [0.4815, 0.6296, 1.0000], [0.5556, 0.6296, 1.0000], [0.6296, 0.6296, 1.0000], [0.7037, 0.6296, 1.0000], [0.7778, 0.6296, 1.0000], [0.8519, 0.6296, 1.0000], [0.9259, 0.6296, 1.0000], [1.0000, 0.6296, 1.0000], [-1.0000, 0.5556, 1.0000], [-0.9259, 0.5556, 1.0000], [-0.8519, 0.5556, 1.0000], [-0.7778, 0.5556, 1.0000], [-0.7037, 0.5556, 1.0000], [-0.6296, 0.5556, 1.0000], [-0.5556, 0.5556, 1.0000], [-0.4815, 0.5556, 1.0000], [-0.4074, 0.5556, 1.0000], [-0.3333, 0.5556, 1.0000], [-0.2593, 0.5556, 1.0000], [-0.1852, 0.5556, 1.0000], [-0.1111, 0.5556, 1.0000], [-0.0370, 0.5556, 1.0000], [0.0370, 0.5556, 1.0000], [0.1111, 0.5556, 1.0000], [0.1852, 0.5556, 1.0000], [0.2593, 0.5556, 1.0000], [0.3333, 0.5556, 1.0000], [0.4074, 0.5556, 1.0000], [0.4815, 0.5556, 1.0000], [0.5556, 0.5556, 1.0000], [0.6296, 0.5556, 1.0000], [0.7037, 0.5556, 1.0000], [0.7778, 0.5556, 1.0000], [0.8519, 0.5556, 1.0000], [0.9259, 0.5556, 1.0000], [1.0000, 0.5556, 1.0000], [-1.0000, 0.4815, 1.0000], [-0.9259, 0.4815, 1.0000], [-0.8519, 0.4815, 1.0000], [-0.7778, 0.4815, 1.0000], [-0.7037, 0.4815, 1.0000], [-0.6296, 0.4815, 1.0000], [-0.5556, 0.4815, 1.0000], [-0.4815, 0.4815, 1.0000], [-0.4074, 0.4815, 1.0000], [-0.3333, 0.4815, 1.0000], [-0.2593, 0.4815, 1.0000], [-0.1852, 0.4815, 1.0000], [-0.1111, 0.4815, 1.0000], [-0.0370, 0.4815, 1.0000], [0.0370, 0.4815, 1.0000], [0.1111, 0.4815, 1.0000], [0.1852, 0.4815, 1.0000], [0.2593, 0.4815, 1.0000], [0.3333, 0.4815, 1.0000], [0.4074, 0.4815, 1.0000], [0.4815, 0.4815, 1.0000], [0.5556, 0.4815, 1.0000], [0.6296, 0.4815, 1.0000], [0.7037, 0.4815, 1.0000], [0.7778, 0.4815, 1.0000], [0.8519, 0.4815, 1.0000], [0.9259, 0.4815, 1.0000], [1.0000, 0.4815, 1.0000], [-1.0000, 0.4074, 1.0000], [-0.9259, 0.4074, 1.0000], [-0.8519, 0.4074, 1.0000], [-0.7778, 0.4074, 1.0000], [-0.7037, 0.4074, 1.0000], [-0.6296, 0.4074, 1.0000], [-0.5556, 0.4074, 1.0000], [-0.4815, 0.4074, 1.0000], [-0.4074, 0.4074, 1.0000], [-0.3333, 0.4074, 1.0000], [-0.2593, 0.4074, 1.0000], [-0.1852, 0.4074, 1.0000], [-0.1111, 0.4074, 1.0000], [-0.0370, 0.4074, 1.0000], [0.0370, 0.4074, 1.0000], [0.1111, 0.4074, 1.0000], [0.1852, 0.4074, 1.0000], [0.2593, 0.4074, 1.0000], [0.3333, 0.4074, 1.0000], [0.4074, 0.4074, 1.0000], [0.4815, 0.4074, 1.0000], [0.5556, 0.4074, 1.0000], [0.6296, 0.4074, 1.0000], [0.7037, 0.4074, 1.0000], [0.7778, 0.4074, 1.0000], [0.8519, 0.4074, 1.0000], [0.9259, 0.4074, 1.0000], [1.0000, 0.4074, 1.0000], [-1.0000, 0.3333, 1.0000], [-0.9259, 0.3333, 1.0000], [-0.8519, 0.3333, 1.0000], [-0.7778, 0.3333, 1.0000], [-0.7037, 0.3333, 1.0000], [-0.6296, 0.3333, 1.0000], [-0.5556, 0.3333, 1.0000], [-0.4815, 0.3333, 1.0000], [-0.4074, 0.3333, 1.0000], [-0.3333, 0.3333, 1.0000], [-0.2593, 0.3333, 1.0000], [-0.1852, 0.3333, 1.0000], [-0.1111, 0.3333, 1.0000], [-0.0370, 0.3333, 1.0000], [0.0370, 0.3333, 1.0000], [0.1111, 0.3333, 1.0000], [0.1852, 0.3333, 1.0000], [0.2593, 0.3333, 1.0000], [0.3333, 0.3333, 1.0000], [0.4074, 0.3333, 1.0000], [0.4815, 0.3333, 1.0000], [0.5556, 0.3333, 1.0000], [0.6296, 0.3333, 1.0000], [0.7037, 0.3333, 1.0000], [0.7778, 0.3333, 1.0000], [0.8519, 0.3333, 1.0000], [0.9259, 0.3333, 1.0000], [1.0000, 0.3333, 1.0000], [-1.0000, 0.2593, 1.0000], [-0.9259, 0.2593, 1.0000], [-0.8519, 0.2593, 1.0000], [-0.7778, 0.2593, 1.0000], [-0.7037, 0.2593, 1.0000], [-0.6296, 0.2593, 1.0000], [-0.5556, 0.2593, 1.0000], [-0.4815, 0.2593, 1.0000], [-0.4074, 0.2593, 1.0000], [-0.3333, 0.2593, 1.0000], [-0.2593, 0.2593, 1.0000], [-0.1852, 0.2593, 1.0000], [-0.1111, 0.2593, 1.0000], [-0.0370, 0.2593, 1.0000], [0.0370, 0.2593, 1.0000], [0.1111, 0.2593, 1.0000], [0.1852, 0.2593, 1.0000], [0.2593, 0.2593, 1.0000], [0.3333, 0.2593, 1.0000], [0.4074, 0.2593, 1.0000], [0.4815, 0.2593, 1.0000], [0.5556, 0.2593, 1.0000], [0.6296, 0.2593, 1.0000], [0.7037, 0.2593, 1.0000], [0.7778, 0.2593, 1.0000], [0.8519, 0.2593, 1.0000], [0.9259, 0.2593, 1.0000], [1.0000, 0.2593, 1.0000], [-1.0000, 0.1852, 1.0000], [-0.9259, 0.1852, 1.0000], [-0.8519, 0.1852, 1.0000], [-0.7778, 0.1852, 1.0000], [-0.7037, 0.1852, 1.0000], [-0.6296, 0.1852, 1.0000], [-0.5556, 0.1852, 1.0000], [-0.4815, 0.1852, 1.0000], [-0.4074, 0.1852, 1.0000], [-0.3333, 0.1852, 1.0000], [-0.2593, 0.1852, 1.0000], [-0.1852, 0.1852, 1.0000], [-0.1111, 0.1852, 1.0000], [-0.0370, 0.1852, 1.0000], [0.0370, 0.1852, 1.0000], [0.1111, 0.1852, 1.0000], [0.1852, 0.1852, 1.0000], [0.2593, 0.1852, 1.0000], [0.3333, 0.1852, 1.0000], [0.4074, 0.1852, 1.0000], [0.4815, 0.1852, 1.0000], [0.5556, 0.1852, 1.0000], [0.6296, 0.1852, 1.0000], [0.7037, 0.1852, 1.0000], [0.7778, 0.1852, 1.0000], [0.8519, 0.1852, 1.0000], [0.9259, 0.1852, 1.0000], [1.0000, 0.1852, 1.0000], [-1.0000, 0.1111, 1.0000], [-0.9259, 0.1111, 1.0000], [-0.8519, 0.1111, 1.0000], [-0.7778, 0.1111, 1.0000], [-0.7037, 0.1111, 1.0000], [-0.6296, 0.1111, 1.0000], [-0.5556, 0.1111, 1.0000], [-0.4815, 0.1111, 1.0000], [-0.4074, 0.1111, 1.0000], [-0.3333, 0.1111, 1.0000], [-0.2593, 0.1111, 1.0000], [-0.1852, 0.1111, 1.0000], [-0.1111, 0.1111, 1.0000], [-0.0370, 0.1111, 1.0000], [0.0370, 0.1111, 1.0000], [0.1111, 0.1111, 1.0000], [0.1852, 0.1111, 1.0000], [0.2593, 0.1111, 1.0000], [0.3333, 0.1111, 1.0000], [0.4074, 0.1111, 1.0000], [0.4815, 0.1111, 1.0000], [0.5556, 0.1111, 1.0000], [0.6296, 0.1111, 1.0000], [0.7037, 0.1111, 1.0000], [0.7778, 0.1111, 1.0000], [0.8519, 0.1111, 1.0000], [0.9259, 0.1111, 1.0000], [1.0000, 0.1111, 1.0000], [-1.0000, 0.0370, 1.0000], [-0.9259, 0.0370, 1.0000], [-0.8519, 0.0370, 1.0000], [-0.7778, 0.0370, 1.0000], [-0.7037, 0.0370, 1.0000], [-0.6296, 0.0370, 1.0000], [-0.5556, 0.0370, 1.0000], [-0.4815, 0.0370, 1.0000], [-0.4074, 0.0370, 1.0000], [-0.3333, 0.0370, 1.0000], [-0.2593, 0.0370, 1.0000], [-0.1852, 0.0370, 1.0000], [-0.1111, 0.0370, 1.0000], [-0.0370, 0.0370, 1.0000], [0.0370, 0.0370, 1.0000], [0.1111, 0.0370, 1.0000], [0.1852, 0.0370, 1.0000], [0.2593, 0.0370, 1.0000], [0.3333, 0.0370, 1.0000], [0.4074, 0.0370, 1.0000], [0.4815, 0.0370, 1.0000], [0.5556, 0.0370, 1.0000], [0.6296, 0.0370, 1.0000], [0.7037, 0.0370, 1.0000], [0.7778, 0.0370, 1.0000], [0.8519, 0.0370, 1.0000], [0.9259, 0.0370, 1.0000], [1.0000, 0.0370, 1.0000], [-1.0000, -0.0370, 1.0000], [-0.9259, -0.0370, 1.0000], [-0.8519, -0.0370, 1.0000], [-0.7778, -0.0370, 1.0000], [-0.7037, -0.0370, 1.0000], [-0.6296, -0.0370, 1.0000], [-0.5556, -0.0370, 1.0000], [-0.4815, -0.0370, 1.0000], [-0.4074, -0.0370, 1.0000], [-0.3333, -0.0370, 1.0000], [-0.2593, -0.0370, 1.0000], [-0.1852, -0.0370, 1.0000], [-0.1111, -0.0370, 1.0000], [-0.0370, -0.0370, 1.0000], [0.0370, -0.0370, 1.0000], [0.1111, -0.0370, 1.0000], [0.1852, -0.0370, 1.0000], [0.2593, -0.0370, 1.0000], [0.3333, -0.0370, 1.0000], [0.4074, -0.0370, 1.0000], [0.4815, -0.0370, 1.0000], [0.5556, -0.0370, 1.0000], [0.6296, -0.0370, 1.0000], [0.7037, -0.0370, 1.0000], [0.7778, -0.0370, 1.0000], [0.8519, -0.0370, 1.0000], [0.9259, -0.0370, 1.0000], [1.0000, -0.0370, 1.0000], [-1.0000, -0.1111, 1.0000], [-0.9259, -0.1111, 1.0000], [-0.8519, -0.1111, 1.0000], [-0.7778, -0.1111, 1.0000], [-0.7037, -0.1111, 1.0000], [-0.6296, -0.1111, 1.0000], [-0.5556, -0.1111, 1.0000], [-0.4815, -0.1111, 1.0000], [-0.4074, -0.1111, 1.0000], [-0.3333, -0.1111, 1.0000], [-0.2593, -0.1111, 1.0000], [-0.1852, -0.1111, 1.0000], [-0.1111, -0.1111, 1.0000], [-0.0370, -0.1111, 1.0000], [0.0370, -0.1111, 1.0000], [0.1111, -0.1111, 1.0000], [0.1852, -0.1111, 1.0000], [0.2593, -0.1111, 1.0000], [0.3333, -0.1111, 1.0000], [0.4074, -0.1111, 1.0000], [0.4815, -0.1111, 1.0000], [0.5556, -0.1111, 1.0000], [0.6296, -0.1111, 1.0000], [0.7037, -0.1111, 1.0000], [0.7778, -0.1111, 1.0000], [0.8519, -0.1111, 1.0000], [0.9259, -0.1111, 1.0000], [1.0000, -0.1111, 1.0000], [-1.0000, -0.1852, 1.0000], [-0.9259, -0.1852, 1.0000], [-0.8519, -0.1852, 1.0000], [-0.7778, -0.1852, 1.0000], [-0.7037, -0.1852, 1.0000], [-0.6296, -0.1852, 1.0000], [-0.5556, -0.1852, 1.0000], [-0.4815, -0.1852, 1.0000], [-0.4074, -0.1852, 1.0000], [-0.3333, -0.1852, 1.0000], [-0.2593, -0.1852, 1.0000], [-0.1852, -0.1852, 1.0000], [-0.1111, -0.1852, 1.0000], [-0.0370, -0.1852, 1.0000], [0.0370, -0.1852, 1.0000], [0.1111, -0.1852, 1.0000], [0.1852, -0.1852, 1.0000], [0.2593, -0.1852, 1.0000], [0.3333, -0.1852, 1.0000], [0.4074, -0.1852, 1.0000], [0.4815, -0.1852, 1.0000], [0.5556, -0.1852, 1.0000], [0.6296, -0.1852, 1.0000], [0.7037, -0.1852, 1.0000], [0.7778, -0.1852, 1.0000], [0.8519, -0.1852, 1.0000], [0.9259, -0.1852, 1.0000], [1.0000, -0.1852, 1.0000], [-1.0000, -0.2593, 1.0000], [-0.9259, -0.2593, 1.0000], [-0.8519, -0.2593, 1.0000], [-0.7778, -0.2593, 1.0000], [-0.7037, -0.2593, 1.0000], [-0.6296, -0.2593, 1.0000], [-0.5556, -0.2593, 1.0000], [-0.4815, -0.2593, 1.0000], [-0.4074, -0.2593, 1.0000], [-0.3333, -0.2593, 1.0000], [-0.2593, -0.2593, 1.0000], [-0.1852, -0.2593, 1.0000], [-0.1111, -0.2593, 1.0000], [-0.0370, -0.2593, 1.0000], [0.0370, -0.2593, 1.0000], [0.1111, -0.2593, 1.0000], [0.1852, -0.2593, 1.0000], [0.2593, -0.2593, 1.0000], [0.3333, -0.2593, 1.0000], [0.4074, -0.2593, 1.0000], [0.4815, -0.2593, 1.0000], [0.5556, -0.2593, 1.0000], [0.6296, -0.2593, 1.0000], [0.7037, -0.2593, 1.0000], [0.7778, -0.2593, 1.0000], [0.8519, -0.2593, 1.0000], [0.9259, -0.2593, 1.0000], [1.0000, -0.2593, 1.0000], [-1.0000, -0.3333, 1.0000], [-0.9259, -0.3333, 1.0000], [-0.8519, -0.3333, 1.0000], [-0.7778, -0.3333, 1.0000], [-0.7037, -0.3333, 1.0000], [-0.6296, -0.3333, 1.0000], [-0.5556, -0.3333, 1.0000], [-0.4815, -0.3333, 1.0000], [-0.4074, -0.3333, 1.0000], [-0.3333, -0.3333, 1.0000], [-0.2593, -0.3333, 1.0000], [-0.1852, -0.3333, 1.0000], [-0.1111, -0.3333, 1.0000], [-0.0370, -0.3333, 1.0000], [0.0370, -0.3333, 1.0000], [0.1111, -0.3333, 1.0000], [0.1852, -0.3333, 1.0000], [0.2593, -0.3333, 1.0000], [0.3333, -0.3333, 1.0000], [0.4074, -0.3333, 1.0000], [0.4815, -0.3333, 1.0000], [0.5556, -0.3333, 1.0000], [0.6296, -0.3333, 1.0000], [0.7037, -0.3333, 1.0000], [0.7778, -0.3333, 1.0000], [0.8519, -0.3333, 1.0000], [0.9259, -0.3333, 1.0000], [1.0000, -0.3333, 1.0000], [-1.0000, -0.4074, 1.0000], [-0.9259, -0.4074, 1.0000], [-0.8519, -0.4074, 1.0000], [-0.7778, -0.4074, 1.0000], [-0.7037, -0.4074, 1.0000], [-0.6296, -0.4074, 1.0000], [-0.5556, -0.4074, 1.0000], [-0.4815, -0.4074, 1.0000], [-0.4074, -0.4074, 1.0000], [-0.3333, -0.4074, 1.0000], [-0.2593, -0.4074, 1.0000], [-0.1852, -0.4074, 1.0000], [-0.1111, -0.4074, 1.0000], [-0.0370, -0.4074, 1.0000], [0.0370, -0.4074, 1.0000], [0.1111, -0.4074, 1.0000], [0.1852, -0.4074, 1.0000], [0.2593, -0.4074, 1.0000], [0.3333, -0.4074, 1.0000], [0.4074, -0.4074, 1.0000], [0.4815, -0.4074, 1.0000], [0.5556, -0.4074, 1.0000], [0.6296, -0.4074, 1.0000], [0.7037, -0.4074, 1.0000], [0.7778, -0.4074, 1.0000], [0.8519, -0.4074, 1.0000], [0.9259, -0.4074, 1.0000], [1.0000, -0.4074, 1.0000], [-1.0000, -0.4815, 1.0000], [-0.9259, -0.4815, 1.0000], [-0.8519, -0.4815, 1.0000], [-0.7778, -0.4815, 1.0000], [-0.7037, -0.4815, 1.0000], [-0.6296, -0.4815, 1.0000], [-0.5556, -0.4815, 1.0000], [-0.4815, -0.4815, 1.0000], [-0.4074, -0.4815, 1.0000], [-0.3333, -0.4815, 1.0000], [-0.2593, -0.4815, 1.0000], [-0.1852, -0.4815, 1.0000], [-0.1111, -0.4815, 1.0000], [-0.0370, -0.4815, 1.0000], [0.0370, -0.4815, 1.0000], [0.1111, -0.4815, 1.0000], [0.1852, -0.4815, 1.0000], [0.2593, -0.4815, 1.0000], [0.3333, -0.4815, 1.0000], [0.4074, -0.4815, 1.0000], [0.4815, -0.4815, 1.0000], [0.5556, -0.4815, 1.0000], [0.6296, -0.4815, 1.0000], [0.7037, -0.4815, 1.0000], [0.7778, -0.4815, 1.0000], [0.8519, -0.4815, 1.0000], [0.9259, -0.4815, 1.0000], [1.0000, -0.4815, 1.0000], [-1.0000, -0.5556, 1.0000], [-0.9259, -0.5556, 1.0000], [-0.8519, -0.5556, 1.0000], [-0.7778, -0.5556, 1.0000], [-0.7037, -0.5556, 1.0000], [-0.6296, -0.5556, 1.0000], [-0.5556, -0.5556, 1.0000], [-0.4815, -0.5556, 1.0000], [-0.4074, -0.5556, 1.0000], [-0.3333, -0.5556, 1.0000], [-0.2593, -0.5556, 1.0000], [-0.1852, -0.5556, 1.0000], [-0.1111, -0.5556, 1.0000], [-0.0370, -0.5556, 1.0000], [0.0370, -0.5556, 1.0000], [0.1111, -0.5556, 1.0000], [0.1852, -0.5556, 1.0000], [0.2593, -0.5556, 1.0000], [0.3333, -0.5556, 1.0000], [0.4074, -0.5556, 1.0000], [0.4815, -0.5556, 1.0000], [0.5556, -0.5556, 1.0000], [0.6296, -0.5556, 1.0000], [0.7037, -0.5556, 1.0000], [0.7778, -0.5556, 1.0000], [0.8519, -0.5556, 1.0000], [0.9259, -0.5556, 1.0000], [1.0000, -0.5556, 1.0000], [-1.0000, -0.6296, 1.0000], [-0.9259, -0.6296, 1.0000], [-0.8519, -0.6296, 1.0000], [-0.7778, -0.6296, 1.0000], [-0.7037, -0.6296, 1.0000], [-0.6296, -0.6296, 1.0000], [-0.5556, -0.6296, 1.0000], [-0.4815, -0.6296, 1.0000], [-0.4074, -0.6296, 1.0000], [-0.3333, -0.6296, 1.0000], [-0.2593, -0.6296, 1.0000], [-0.1852, -0.6296, 1.0000], [-0.1111, -0.6296, 1.0000], [-0.0370, -0.6296, 1.0000], [0.0370, -0.6296, 1.0000], [0.1111, -0.6296, 1.0000], [0.1852, -0.6296, 1.0000], [0.2593, -0.6296, 1.0000], [0.3333, -0.6296, 1.0000], [0.4074, -0.6296, 1.0000], [0.4815, -0.6296, 1.0000], [0.5556, -0.6296, 1.0000], [0.6296, -0.6296, 1.0000], [0.7037, -0.6296, 1.0000], [0.7778, -0.6296, 1.0000], [0.8519, -0.6296, 1.0000], [0.9259, -0.6296, 1.0000], [1.0000, -0.6296, 1.0000], [-1.0000, -0.7037, 1.0000], [-0.9259, -0.7037, 1.0000], [-0.8519, -0.7037, 1.0000], [-0.7778, -0.7037, 1.0000], [-0.7037, -0.7037, 1.0000], [-0.6296, -0.7037, 1.0000], [-0.5556, -0.7037, 1.0000], [-0.4815, -0.7037, 1.0000], [-0.4074, -0.7037, 1.0000], [-0.3333, -0.7037, 1.0000], [-0.2593, -0.7037, 1.0000], [-0.1852, -0.7037, 1.0000], [-0.1111, -0.7037, 1.0000], [-0.0370, -0.7037, 1.0000], [0.0370, -0.7037, 1.0000], [0.1111, -0.7037, 1.0000], [0.1852, -0.7037, 1.0000], [0.2593, -0.7037, 1.0000], [0.3333, -0.7037, 1.0000], [0.4074, -0.7037, 1.0000], [0.4815, -0.7037, 1.0000], [0.5556, -0.7037, 1.0000], [0.6296, -0.7037, 1.0000], [0.7037, -0.7037, 1.0000], [0.7778, -0.7037, 1.0000], [0.8519, -0.7037, 1.0000], [0.9259, -0.7037, 1.0000], [1.0000, -0.7037, 1.0000], [-1.0000, -0.7778, 1.0000], [-0.9259, -0.7778, 1.0000], [-0.8519, -0.7778, 1.0000], [-0.7778, -0.7778, 1.0000], [-0.7037, -0.7778, 1.0000], [-0.6296, -0.7778, 1.0000], [-0.5556, -0.7778, 1.0000], [-0.4815, -0.7778, 1.0000], [-0.4074, -0.7778, 1.0000], [-0.3333, -0.7778, 1.0000], [-0.2593, -0.7778, 1.0000], [-0.1852, -0.7778, 1.0000], [-0.1111, -0.7778, 1.0000], [-0.0370, -0.7778, 1.0000], [0.0370, -0.7778, 1.0000], [0.1111, -0.7778, 1.0000], [0.1852, -0.7778, 1.0000], [0.2593, -0.7778, 1.0000], [0.3333, -0.7778, 1.0000], [0.4074, -0.7778, 1.0000], [0.4815, -0.7778, 1.0000], [0.5556, -0.7778, 1.0000], [0.6296, -0.7778, 1.0000], [0.7037, -0.7778, 1.0000], [0.7778, -0.7778, 1.0000], [0.8519, -0.7778, 1.0000], [0.9259, -0.7778, 1.0000], [1.0000, -0.7778, 1.0000], [-1.0000, -0.8519, 1.0000], [-0.9259, -0.8519, 1.0000], [-0.8519, -0.8519, 1.0000], [-0.7778, -0.8519, 1.0000], [-0.7037, -0.8519, 1.0000], [-0.6296, -0.8519, 1.0000], [-0.5556, -0.8519, 1.0000], [-0.4815, -0.8519, 1.0000], [-0.4074, -0.8519, 1.0000], [-0.3333, -0.8519, 1.0000], [-0.2593, -0.8519, 1.0000], [-0.1852, -0.8519, 1.0000], [-0.1111, -0.8519, 1.0000], [-0.0370, -0.8519, 1.0000], [0.0370, -0.8519, 1.0000], [0.1111, -0.8519, 1.0000], [0.1852, -0.8519, 1.0000], [0.2593, -0.8519, 1.0000], [0.3333, -0.8519, 1.0000], [0.4074, -0.8519, 1.0000], [0.4815, -0.8519, 1.0000], [0.5556, -0.8519, 1.0000], [0.6296, -0.8519, 1.0000], [0.7037, -0.8519, 1.0000], [0.7778, -0.8519, 1.0000], [0.8519, -0.8519, 1.0000], [0.9259, -0.8519, 1.0000], [1.0000, -0.8519, 1.0000], [-1.0000, -0.9259, 1.0000], [-0.9259, -0.9259, 1.0000], [-0.8519, -0.9259, 1.0000], [-0.7778, -0.9259, 1.0000], [-0.7037, -0.9259, 1.0000], [-0.6296, -0.9259, 1.0000], [-0.5556, -0.9259, 1.0000], [-0.4815, -0.9259, 1.0000], [-0.4074, -0.9259, 1.0000], [-0.3333, -0.9259, 1.0000], [-0.2593, -0.9259, 1.0000], [-0.1852, -0.9259, 1.0000], [-0.1111, -0.9259, 1.0000], [-0.0370, -0.9259, 1.0000], [0.0370, -0.9259, 1.0000], [0.1111, -0.9259, 1.0000], [0.1852, -0.9259, 1.0000], [0.2593, -0.9259, 1.0000], [0.3333, -0.9259, 1.0000], [0.4074, -0.9259, 1.0000], [0.4815, -0.9259, 1.0000], [0.5556, -0.9259, 1.0000], [0.6296, -0.9259, 1.0000], [0.7037, -0.9259, 1.0000], [0.7778, -0.9259, 1.0000], [0.8519, -0.9259, 1.0000], [0.9259, -0.9259, 1.0000], [1.0000, -0.9259, 1.0000], [-1., -1., 1.], [-0.9259, -1.0000, 1.0000], [-0.8519, -1.0000, 1.0000], [-0.7778, -1.0000, 1.0000], [-0.7037, -1.0000, 1.0000], [-0.6296, -1.0000, 1.0000], [-0.5556, -1.0000, 1.0000], [-0.4815, -1.0000, 1.0000], [-0.4074, -1.0000, 1.0000], [-0.3333, -1.0000, 1.0000], [-0.2593, -1.0000, 1.0000], [-0.1852, -1.0000, 1.0000], [-0.1111, -1.0000, 1.0000], [-0.0370, -1.0000, 1.0000], [0.0370, -1.0000, 1.0000], [0.1111, -1.0000, 1.0000], [0.1852, -1.0000, 1.0000], [0.2593, -1.0000, 1.0000], [0.3333, -1.0000, 1.0000], [0.4074, -1.0000, 1.0000], [0.4815, -1.0000, 1.0000], [0.5556, -1.0000, 1.0000], [0.6296, -1.0000, 1.0000], [0.7037, -1.0000, 1.0000], [0.7778, -1.0000, 1.0000], [0.8519, -1.0000, 1.0000], [0.9259, -1.0000, 1.0000], [1., -1., 1.],])

    transform = math.matrix([
      [math.cos(1), math.sin(1), 1],
      [math.cos(1), math.sin(1), 1],
      [0, 0, 1],
    ])
    transform = math.transpose(transform)

    coords = math.multiply(grid, transform)

    function randn() {
      var u1 = Math.random();
      var u2 = Math.random();

      var z0 = Math.sqrt(-2.0 * Math.log(u1)) * Math.cos(Math.PI * 2 * u2);

      return z0;
    }

    async function test() {
      const sess_enc = new onnx.InferenceSession()
      await sess_enc.loadModel('./svae_encoder.onnx')
      const input_enc = new onnx.Tensor(new Float32Array(28 * 28), 'float32', [28, 28])
      const outputMapEnc = await sess_enc.run([input_enc])
      const outputTensorEnc = outputMapEnc.values().next().value

      // Sample.
      mu = Array.prototype.slice.call(outputTensorEnc.data.slice(0, 5))
      logvar = Array.prototype.slice.call(outputTensorEnc.data.slice(5, 10))
      std = math.exp(math.multiply(0.5, logvar))
      eps = math.matrix([randn(), randn(), randn(), randn(), randn()])
      z = math.add(mu, math.dotMultiply(std, eps))
      theta = math.subset(z, math.index(0))
      delta_x0 = math.subset(z, math.index(1))
      delta_x1 = math.subset(z, math.index(2))
      z = math.subset(z, math.index([3, 4]))

      // Transform coords.
      transform = math.matrix([
        [math.cos(theta), -math.sin(theta), delta_x0],
        [math.sin(theta), math.cos(theta), delta_x1],
        [0.0, 0.0, 1.0],
      ])
      transform = math.transpose(transform)
      coords = math.multiply(grid, transform)
      // console.log(coords._data[0])

      // Generate input for the model.
      x = []
      for (var i = 0; i < 784; i++) {
        x.push(z._data[0])
        x.push(z._data[1])
        x.push(coords._data[i][0])
        x.push(coords._data[i][1])
      }

      // Decode.
      const sess_dec = new onnx.InferenceSession()
      await sess_dec.loadModel('./svae_decoder.onnx')
      const input_dec = new onnx.Tensor(x, 'float32', [784, 4])
      const outputMapDec = await sess_dec.run([input_dec])
      const outputTensorDec = outputMapDec.values().next().value

      var c = document.getElementById("svae_out");
      var ctx = c.getContext("2d"); 
    }
    test()
  </script>

  <canvas id="svae_out" width="28" height="28" style="border:1px solid #d3d3d3;"></canvas>
</body>

</html>